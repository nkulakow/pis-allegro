<!DOCTYPE html>
<html lang="en">
<head>
    <title>Your first Spring application</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

    <style>
        .custom-select {
            width: 200px; /* Set the desired width */
        }
    </style>
</head>
<body>
<div>
    <h2>Add a new product</h2>
    <form id="uploadForm" enctype="multipart/form-data">
        <label for="name">Enter name:</label>
        <input type="text" name="name" id="name">
        <br>
        <label for="categories">Select categories:</label>
        <select name="categories" id="categories" class="custom-select" multiple>
        </select>
        <br>
        <label for="price">Enter price:</label>
        <input type="number" step="0.01" name="price" id="price">
        <br>
        <label for="description">Enter description:</label>
        <input type="text" name="description" id="description">
        <br>
        <label for="photo">Select product photo:</label>
        <input type="file" name="photo" id="photo" accept="image/*">
        <br>
        <button type="submit">Upload</button>
    </form>
</div>
<div id="responseMessage"></div>
<script>
    $(document).ready(function() {
        $.ajax({
            url: '/products/get-categories',
            type: 'GET',
            dataType: 'json',
            success: function(categoryNames) {
                var select = $('#categories');
                $.each(categoryNames, function(index, categoryNames) {
                    var option = $('<option>').val(categoryNames).text(categoryNames);
                    select.append(option);
                });
            },
            error: function() {
                console.error('Failed to fetch categories.');
            }
        });
        $('#uploadForm').submit(function(event) {
            event.preventDefault();
            var formData = new FormData($(this)[0]);

            $.ajax({
                url: '/products/add',
                type: 'POST',
                data: formData,
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function(response) {
                    console.log("OK");
                    var resultDiv = $("#responseMessage");
                    resultDiv.empty();
                    resultDiv.append("<p>" + response + "</p>");
                }
            });
        });
        $('#categories').select2();
    });
</script>

<div>
    <h2>Your products</h2>
    <ul>
        <li>
            Product 1
            <button>Edit</button>
        </li>
        <li>
            Product 2
            <button>Edit</button>
        </li>
    </ul>
</div>
</body>
</html>